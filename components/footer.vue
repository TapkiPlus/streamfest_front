<template>
  <footer class="footer">
    <div class="footer-top">
      <div class="container footer-top-wrapper">
        <div class="footer-top-left">
          <p>
            Старые медиа ушли или трансформировались. Новым — достаточно
            веб-камеры. В&nbsp;2020 году мировая аудитория стримов превысила 1
            млрд человек. Типичный зритель смотрит их по 95&nbsp;минут в день.
          </p>
          <p>
            Российская аудитория стримов растет в два раза быстрее мировой — на
            20% в год. Стримфест — это точка входа в новую реальность.<br />Ждем
            вас 7–8 августа в Технопарке Сколково!
          </p>
          <div class="footer-top-social">
            <a
              href="https://vk.com/streamfest"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M35.6791 25.8387C35.5824 25.681 34.9838 24.4146 32.1036 21.8118C29.0884 19.0863 29.4934 19.5289 33.1252 14.8162C35.3371 11.9461 36.2214 10.1933 35.9446 9.44401C35.6814 8.72977 34.0545 8.91819 34.0545 8.91819L28.6451 8.94886C28.6451 8.94886 28.2446 8.89628 27.9453 9.06936C27.655 9.24025 27.4683 9.63462 27.4683 9.63462C27.4683 9.63462 26.611 11.8562 25.4679 13.7448C23.0579 17.7301 22.0926 17.9404 21.6988 17.6929C20.783 17.1166 21.0125 15.3749 21.0125 14.1392C21.0125 10.2766 21.6133 8.66623 19.8402 8.24995C19.2507 8.11192 18.8186 8.0199 17.3133 8.00457C15.3826 7.98485 13.7468 8.01114 12.8219 8.45152C12.2054 8.7451 11.7306 9.40019 12.0209 9.43744C12.3787 9.48345 13.1887 9.64996 13.6185 10.2196C14.1743 10.9536 14.154 12.6055 14.154 12.6055C14.154 12.6055 14.4736 17.1517 13.4092 17.717C12.6779 18.1048 11.6766 17.3138 9.5277 13.6966C8.42737 11.8453 7.59481 9.79675 7.59481 9.79675C7.59481 9.79675 7.43505 9.41553 7.14928 9.21177C6.80275 8.9642 6.31672 8.88532 6.31672 8.88532L1.17284 8.91599C1.17284 8.91599 0.401032 8.9379 0.117511 9.26435C-0.134508 9.55575 0.0972595 10.1561 0.0972595 10.1561C0.0972595 10.1561 4.12506 19.3295 8.68389 23.9545C12.8669 28.194 17.6148 27.9157 17.6148 27.9157H19.766C19.766 27.9157 20.4163 27.8456 20.747 27.4973C21.053 27.1774 21.0418 26.5771 21.0418 26.5771C21.0418 26.5771 20.999 23.7661 22.3401 23.352C23.661 22.9445 25.3576 26.0688 27.1555 27.2716C28.5146 28.1808 29.5474 27.9815 29.5474 27.9815L34.356 27.9157C34.356 27.9157 36.8717 27.7646 35.6791 25.8387Z"
                  fill="white"
                />
              </svg>
            </a>
            <a
              href="https://www.tiktok.com/@streamfest"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M29.3914 11.5195C27.9076 11.5195 26.5385 11.028 25.4391 10.1987C24.1782 9.24809 23.2723 7.85363 22.9523 6.24641C22.8731 5.8493 22.8305 5.43949 22.8264 5.01953H18.5877V16.6017L18.5826 22.9458C18.5826 24.6419 17.4781 26.08 15.9471 26.5858C15.5027 26.7326 15.0228 26.8021 14.5231 26.7747C13.8853 26.7397 13.2876 26.5472 12.7681 26.2364C11.6626 25.5753 10.9131 24.3758 10.8928 23.0037C10.8608 20.8592 12.5945 19.1108 14.7374 19.1108C15.1605 19.1108 15.5667 19.1799 15.9471 19.3053V16.1396V15.0016C15.5459 14.9422 15.1376 14.9112 14.7248 14.9112C12.3792 14.9112 10.1854 15.8862 8.61729 17.6427C7.43206 18.9702 6.72112 20.6637 6.61143 22.4395C6.46772 24.7724 7.32135 26.99 8.97682 28.6262C9.22006 28.8664 9.47549 29.0893 9.7426 29.295C11.1619 30.3873 12.8971 30.9794 14.7248 30.9794C15.1376 30.9794 15.5459 30.9489 15.9471 30.8895C17.6543 30.6366 19.2296 29.8551 20.4727 28.6262C22.0002 27.1165 22.8442 25.1121 22.8533 22.9788L22.8315 13.5051C23.5602 14.0672 24.3569 14.5324 25.2121 14.8934C26.5421 15.4546 27.9523 15.7389 29.4036 15.7384V12.6606V11.5185C29.4046 11.5195 29.3924 11.5195 29.3914 11.5195Z"
                  fill="white"
                />
              </svg>
            </a>
            <a
              href="https://t.me/streamfest"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clip-path="url(#tg)">
                  <path
                    d="M15.2018 21.4459L14.7717 27.4952C15.387 27.4952 15.6535 27.2309 15.9731 26.9135L18.858 24.1564L24.8358 28.5341C25.9322 29.1451 26.7046 28.8234 27.0003 27.5255L30.9242 9.1392L30.9252 9.13812C31.273 7.51745 30.3392 6.8837 29.271 7.28129L6.20684 16.1115C4.63276 16.7225 4.65659 17.6 5.93926 17.9976L11.8358 19.8317L25.5324 11.2615C26.177 10.8346 26.7631 11.0708 26.281 11.4976L15.2018 21.4459Z"
                    fill="white"
                  />
                </g>
                <defs>
                  <clipPath id="tg">
                    <rect
                      width="26"
                      height="26"
                      fill="white"
                      transform="translate(5 5)"
                    />
                  </clipPath>
                </defs>
              </svg>
            </a>
            <a
              href="https://www.facebook.com/StreamfestRU"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M22.6266 9.31708H25V5.18308C24.5905 5.12675 23.1823 5 21.5423 5C18.1203 5 15.7762 7.15258 15.7762 11.1089V14.75H12V19.3715H15.7762V31H20.406V19.3726H24.0294L24.6046 14.7511H20.4049V11.5672C20.406 10.2314 20.7656 9.31708 22.6266 9.31708Z"
                  fill="white"
                />
              </svg>
            </a>
            <a
              href="https://www.instagram.com/streamfest_ru/"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M30.9745 12.9243C30.9135 11.5429 30.6901 10.5931 30.3701 9.77013C30.04 8.89657 29.5321 8.11446 28.8666 7.46429C28.2165 6.80401 27.4292 6.29094 26.5657 5.96595C25.738 5.64593 24.7932 5.42253 23.4117 5.36162C22.0199 5.29555 21.5781 5.28027 18.0481 5.28027C14.5181 5.28027 14.0763 5.29555 12.6897 5.35646C11.3082 5.41737 10.3584 5.64097 9.53565 5.9608C8.66188 6.29094 7.87978 6.79885 7.22961 7.46429C6.56933 8.11446 6.05646 8.90172 5.73127 9.76517C5.41125 10.5931 5.18785 11.5377 5.12694 12.9192C5.06087 14.311 5.04559 14.7528 5.04559 18.2828C5.04559 21.8128 5.06087 22.2546 5.12178 23.6413C5.18269 25.0228 5.40629 25.9725 5.72631 26.7955C6.05646 27.6691 6.56933 28.4512 7.22961 29.1013C7.87978 29.7616 8.66704 30.2747 9.53049 30.5997C10.3584 30.9197 11.303 31.1431 12.6847 31.204C14.0711 31.2651 14.5132 31.2802 18.0432 31.2802C21.5731 31.2802 22.015 31.2651 23.4016 31.204C24.7831 31.1431 25.7329 30.9197 26.5556 30.5997C28.303 29.9241 29.6844 28.5426 30.36 26.7955C30.6798 25.9676 30.9034 25.0228 30.9643 23.6413C31.0252 22.2546 31.0405 21.8128 31.0405 18.2828C31.0405 14.7528 31.0354 14.311 30.9745 12.9243ZM28.6331 23.5397C28.5772 24.8095 28.3639 25.4952 28.1861 25.9523C27.7492 27.085 26.8503 27.9839 25.7176 28.4208C25.2605 28.5986 24.5698 28.8119 23.305 28.8676C21.9336 28.9287 21.5223 28.9438 18.0533 28.9438C14.5842 28.9438 14.1678 28.9287 12.8014 28.8676C11.5316 28.8119 10.8459 28.5986 10.3888 28.4208C9.82512 28.2125 9.31205 27.8823 8.8956 27.4506C8.46387 27.029 8.13373 26.5211 7.92541 25.9574C7.74764 25.5003 7.53436 24.8095 7.47861 23.5449C7.4175 22.1735 7.40242 21.762 7.40242 18.2929C7.40242 14.8239 7.4175 14.4074 7.47861 13.0412C7.53436 11.7714 7.74764 11.0857 7.92541 10.6286C8.13373 10.0648 8.46387 9.55189 8.90076 9.13524C9.32217 8.70352 9.83008 8.37338 10.3939 8.16525C10.8511 7.98748 11.5419 7.7742 12.8065 7.71825C14.1779 7.65734 14.5894 7.64206 18.0582 7.64206C21.5325 7.64206 21.9438 7.65734 23.3102 7.71825C24.5799 7.7742 25.2656 7.98748 25.7227 8.16525C26.2864 8.37338 26.7995 8.70352 27.2159 9.13524C27.6476 9.55685 27.9778 10.0648 28.1861 10.6286C28.3639 11.0857 28.5772 11.7764 28.6331 13.0412C28.694 14.4126 28.7093 14.8239 28.7093 18.2929C28.7093 21.762 28.694 22.1683 28.6331 23.5397ZM18.0481 11.6037C14.3608 11.6037 11.3691 14.5953 11.3691 18.2828C11.3691 21.9703 14.3608 24.9618 18.0481 24.9618C21.7356 24.9618 24.7272 21.9703 24.7272 18.2828C24.7272 14.5953 21.7356 11.6037 18.0481 11.6037ZM18.0481 22.6153C15.656 22.6153 13.7156 20.6751 13.7156 18.2828C13.7156 15.8904 15.656 13.9502 18.0481 13.9502C20.4405 13.9502 22.3806 15.8904 22.3806 18.2828C22.3806 20.6751 20.4405 22.6153 18.0481 22.6153ZM24.9913 12.8991C25.8526 12.8991 26.5508 12.2009 26.5508 11.3398C26.5508 10.4785 25.8526 9.78054 24.9913 9.78054C24.1303 9.78054 23.4321 10.4785 23.4321 11.3398C23.4321 12.2009 24.1303 12.8991 24.9913 12.8991Z"
                  fill="white"
                />
              </svg>
            </a>
            <a
              href="https://twitter.com/streamfest_ru"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M34 8.078C32.81 8.6 31.542 8.946 30.22 9.114C31.58 8.302 32.618 7.026 33.106 5.488C31.838 6.244 30.438 6.778 28.946 7.076C27.742 5.794 26.026 5 24.154 5C20.522 5 17.598 7.948 17.598 11.562C17.598 12.082 17.642 12.582 17.75 13.058C12.296 12.792 7.47 10.178 4.228 6.196C3.662 7.178 3.33 8.302 3.33 9.512C3.33 11.784 4.5 13.798 6.244 14.964C5.19 14.944 4.156 14.638 3.28 14.156C3.28 14.176 3.28 14.202 3.28 14.228C3.28 17.416 5.554 20.064 8.536 20.674C8.002 20.82 7.42 20.89 6.816 20.89C6.396 20.89 5.972 20.866 5.574 20.778C6.424 23.376 8.836 25.286 11.704 25.348C9.472 27.094 6.638 28.146 3.57 28.146C3.032 28.146 2.516 28.122 2 28.056C4.906 29.93 8.35 31 12.064 31C24.136 31 30.736 21 30.736 12.332C30.736 12.042 30.726 11.762 30.712 11.484C32.014 10.56 33.108 9.406 34 8.078Z"
                  fill="white"
                />
              </svg>
            </a>
          </div>
        </div>
        <div class="footer-top-right">
          <p>Вливайся!</p>
          <!-- VK Widget -->
          <div id="vk_groups"></div>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="container footer-bottom-wrapper">
        <p>© 2015 – 2021, Стримфест</p>
        <a class="footer-cat mobile-hidden" @click="scrollToTop">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            width="31px"
            height="24px"
          >
            <path
              fill-rule="evenodd"
              fill="rgb(0, 96, 207)"
              d="M29.962,14.508 L25.450,0.927 C25.196,0.164 24.297,-0.085 23.726,0.451 L19.662,4.269 C18.157,3.111 12.590,3.111 11.085,4.269 L7.021,0.451 C6.450,-0.085 5.550,0.164 5.297,0.927 L0.785,14.508 C-0.138,17.287 1.042,20.385 3.552,21.635 C6.723,23.214 10.732,23.951 15.374,23.951 C20.015,23.951 24.024,23.214 27.195,21.635 C29.705,20.385 30.885,17.287 29.962,14.508 Z"
            />
          </svg>
        </a>
        <p class="mobile-hidden">
          <nuxt-link to="/contact" class="link">Контакты</nuxt-link>
          <a href="/#subscribe" class="link">О фестивале</a>
        </p>
      </div>
    </div>
    <nuxt-link
      v-show="isWidgetsVisible && cartTotalCount"
      :data-num="cartTotalCount"
      class="cart-fix"
      to="/cart"
    >
      <div class="cart-fix__counter"></div>
      <img src="/cart-small.svg" alt="cart-icon" />
    </nuxt-link>
    <div v-show="isWidgetsVisible" id="vk_community_messages"></div>
  </footer>
</template>

<script>
import { mapState } from "vuex";

export default {
  mounted() {
    const script = document.createElement("script");
    script.onload = () => {
      VK.Widgets.CommunityMessages("vk_community_messages", 122887579, {
        disableExpandChatSound: "1",
        disableButtonTooltip: "1"
      });

      VK.Widgets.Group(
        "vk_groups",
        { mode: 3, width: "auto", no_cover: 1 },
        122887579
      );
    };
    script.src = "https://vk.com/js/api/openapi.js?168";
    document.body.appendChild(script);
  },
  methods: {
    scrollToTop() {
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
  },
  computed: {
    ...mapState("cart", ["data"]),
    isWidgetsVisible() {
    return !['/cart', '/checkout'].includes(this.$route.path)
    },
    cartTotalCount() {
      return this.data.cartitem_set
        ? this.data.cartitem_set.reduce(
            (acc, { quantity }) => acc + quantity,
            0
          )
        : 0;
    },
  }
};
</script>
