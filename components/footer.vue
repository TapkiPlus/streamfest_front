<template>
  <footer class="footer">
    <div class="footer-top">
      <div class="container footer-top-wrapper">
        <div class="footer-top-left">
          <p>
            Старые медиа ушли или трансформировались. Новым — достаточно
            веб-камеры. В&nbsp;2020 году мировая аудитория стримов превысила 1
            млрд человек. Типичный зритель смотрит их по 95&nbsp;минут в день.
          </p>
          <p>
            Российская аудитория стримов растет в два раза быстрее мировой — на
            20% в год. Стримфест — это точка входа в новую реальность.<br />До
            новых встреч на празднике живого общения!
          </p>
          <div class="footer-top-social">
            <a
              href="https://vk.com/streamfest"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M35.6791 25.8387C35.5824 25.681 34.9838 24.4146 32.1036 21.8118C29.0884 19.0863 29.4934 19.5289 33.1252 14.8162C35.3371 11.9461 36.2214 10.1933 35.9446 9.44401C35.6814 8.72977 34.0545 8.91819 34.0545 8.91819L28.6451 8.94886C28.6451 8.94886 28.2446 8.89628 27.9453 9.06936C27.655 9.24025 27.4683 9.63462 27.4683 9.63462C27.4683 9.63462 26.611 11.8562 25.4679 13.7448C23.0579 17.7301 22.0926 17.9404 21.6988 17.6929C20.783 17.1166 21.0125 15.3749 21.0125 14.1392C21.0125 10.2766 21.6133 8.66623 19.8402 8.24995C19.2507 8.11192 18.8186 8.0199 17.3133 8.00457C15.3826 7.98485 13.7468 8.01114 12.8219 8.45152C12.2054 8.7451 11.7306 9.40019 12.0209 9.43744C12.3787 9.48345 13.1887 9.64996 13.6185 10.2196C14.1743 10.9536 14.154 12.6055 14.154 12.6055C14.154 12.6055 14.4736 17.1517 13.4092 17.717C12.6779 18.1048 11.6766 17.3138 9.5277 13.6966C8.42737 11.8453 7.59481 9.79675 7.59481 9.79675C7.59481 9.79675 7.43505 9.41553 7.14928 9.21177C6.80275 8.9642 6.31672 8.88532 6.31672 8.88532L1.17284 8.91599C1.17284 8.91599 0.401032 8.9379 0.117511 9.26435C-0.134508 9.55575 0.0972595 10.1561 0.0972595 10.1561C0.0972595 10.1561 4.12506 19.3295 8.68389 23.9545C12.8669 28.194 17.6148 27.9157 17.6148 27.9157H19.766C19.766 27.9157 20.4163 27.8456 20.747 27.4973C21.053 27.1774 21.0418 26.5771 21.0418 26.5771C21.0418 26.5771 20.999 23.7661 22.3401 23.352C23.661 22.9445 25.3576 26.0688 27.1555 27.2716C28.5146 28.1808 29.5474 27.9815 29.5474 27.9815L34.356 27.9157C34.356 27.9157 36.8717 27.7646 35.6791 25.8387Z"
                  fill="white"
                />
              </svg>
            </a>
            <a
              href="https://discord.gg/uCrQmBntZP"
              target="_blank"
              rel="noopener noreferrer"
            >
              <img src="/diskord_logo_w.svg" />
            </a>
            <a
              href="https://www.tiktok.com/@streamfest"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M29.3914 11.5195C27.9076 11.5195 26.5385 11.028 25.4391 10.1987C24.1782 9.24809 23.2723 7.85363 22.9523 6.24641C22.8731 5.8493 22.8305 5.43949 22.8264 5.01953H18.5877V16.6017L18.5826 22.9458C18.5826 24.6419 17.4781 26.08 15.9471 26.5858C15.5027 26.7326 15.0228 26.8021 14.5231 26.7747C13.8853 26.7397 13.2876 26.5472 12.7681 26.2364C11.6626 25.5753 10.9131 24.3758 10.8928 23.0037C10.8608 20.8592 12.5945 19.1108 14.7374 19.1108C15.1605 19.1108 15.5667 19.1799 15.9471 19.3053V16.1396V15.0016C15.5459 14.9422 15.1376 14.9112 14.7248 14.9112C12.3792 14.9112 10.1854 15.8862 8.61729 17.6427C7.43206 18.9702 6.72112 20.6637 6.61143 22.4395C6.46772 24.7724 7.32135 26.99 8.97682 28.6262C9.22006 28.8664 9.47549 29.0893 9.7426 29.295C11.1619 30.3873 12.8971 30.9794 14.7248 30.9794C15.1376 30.9794 15.5459 30.9489 15.9471 30.8895C17.6543 30.6366 19.2296 29.8551 20.4727 28.6262C22.0002 27.1165 22.8442 25.1121 22.8533 22.9788L22.8315 13.5051C23.5602 14.0672 24.3569 14.5324 25.2121 14.8934C26.5421 15.4546 27.9523 15.7389 29.4036 15.7384V12.6606V11.5185C29.4046 11.5195 29.3924 11.5195 29.3914 11.5195Z"
                  fill="white"
                />
              </svg>
            </a>
            <a
              href="https://t.me/streamfest"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                width="36"
                height="36"
                viewBox="0 0 36 36"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clip-path="url(#tg)">
                  <path
                    d="M15.2018 21.4459L14.7717 27.4952C15.387 27.4952 15.6535 27.2309 15.9731 26.9135L18.858 24.1564L24.8358 28.5341C25.9322 29.1451 26.7046 28.8234 27.0003 27.5255L30.9242 9.1392L30.9252 9.13812C31.273 7.51745 30.3392 6.8837 29.271 7.28129L6.20684 16.1115C4.63276 16.7225 4.65659 17.6 5.93926 17.9976L11.8358 19.8317L25.5324 11.2615C26.177 10.8346 26.7631 11.0708 26.281 11.4976L15.2018 21.4459Z"
                    fill="white"
                  />
                </g>
                <defs>
                  <clipPath id="tg">
                    <rect
                      width="26"
                      height="26"
                      fill="white"
                      transform="translate(5 5)"
                    />
                  </clipPath>
                </defs>
              </svg>
            </a>
          </div>
        </div>
        <div class="footer-top-right">
          <p>Вливайся!</p>
          <!-- VK Widget -->
          <div id="vk_groups"></div>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="container footer-bottom-wrapper">
        <p>© 2015 – 2022, Стримфест</p>
        <a class="footer-cat mobile-hidden" @click="scrollToTop">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            width="31px"
            height="24px"
          >
            <path
              fill-rule="evenodd"
              fill="rgb(0, 96, 207)"
              d="M29.962,14.508 L25.450,0.927 C25.196,0.164 24.297,-0.085 23.726,0.451 L19.662,4.269 C18.157,3.111 12.590,3.111 11.085,4.269 L7.021,0.451 C6.450,-0.085 5.550,0.164 5.297,0.927 L0.785,14.508 C-0.138,17.287 1.042,20.385 3.552,21.635 C6.723,23.214 10.732,23.951 15.374,23.951 C20.015,23.951 24.024,23.214 27.195,21.635 C29.705,20.385 30.885,17.287 29.962,14.508 Z"
            />
          </svg>
        </a>
        <p class="mobile-hidden">
          <nuxt-link to="/contact" class="link">Контакты</nuxt-link>
          <a href="/#subscribe" class="link">О фестивале</a>
        </p>
      </div>
    </div>
    <nuxt-link
      v-show="isWidgetVisible && cartTotalCount"
      :data-num="cartTotalCount"
      class="cart-fix"
      to="/cart"
    >
      <div class="cart-fix__counter"></div>
      <img src="/cart-small.svg" alt="cart-icon" loading="lazy" />
    </nuxt-link>
    <div v-show="isWidgetVisible" id="vk_community_messages"></div>
  </footer>
</template>

<script>
import { mapState } from "vuex";
export default {
  data() {
    return {
      isWidgetVisible: false,
    };
  },
  computed: {
    ...mapState("cart", ["data"]),
    cartTotalCount() {
      return this.data.cartitem_set
        ? this.data.cartitem_set.reduce(
            (acc, { quantity }) => acc + quantity,
            0
          )
        : 0;
    },
  },
  mounted() {
    VK.Widgets.CommunityMessages("vk_community_messages", 122887579, {
      disableExpandChatSound: "1",
      disableButtonTooltip: "1",
    });
    VK.Widgets.Group(
      "vk_groups",
      { mode: 3, width: "auto", no_cover: 1 },
      122887579
    );
    this.checkRoutePath();
  },
  watch: {
    "$route.path": function () {
      this.checkRoutePath();
    },
  },
  methods: {
    checkRoutePath() {
      this.isWidgetVisible = !["/cart", "/checkout"].includes(this.$route.path);
    },
    scrollToTop() {
      window.scrollTo({ top: 0, behavior: "smooth" });
    },
  },
};
</script>
