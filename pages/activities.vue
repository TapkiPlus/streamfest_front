<template>
  <section class="activities">
    <div class="container">
      <ul class="activities-tabs">
        <li
          class="activities-tabs__item"
          :class="{ _active: activeTable === 1 }"
        >
          <nuxt-link to="/activities">
            <svg
              viewBox="0 0 109 108"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g filter="url(#filter0_d)">
                <path
                  d="M32.7785 51.9913C32.7152 51.9913 32.6518 51.989 32.5877 51.9852L5.05629 50.2663C4.00878 50.2015 3.06883 49.6026 2.56682 48.6817C2.06557 47.7608 2.07167 46.6462 2.58437 45.7306C2.72856 45.4728 6.19841 39.3547 12.8062 34.0187C21.7357 26.8089 32.1162 24.4705 42.8249 27.2568C43.7137 27.4879 44.4507 28.1075 44.8322 28.9429C45.2136 29.7783 45.1984 30.7411 44.7902 31.5636L35.5121 50.2945C34.9948 51.3382 33.932 51.9913 32.7785 51.9913Z"
                  fill="#FF5B5B"
                />
                <path
                  d="M54.974 100C54.472 100 53.97 99.8765 53.5145 99.6278C52.5937 99.1258 51.9948 98.1866 51.9291 97.1391L50.211 69.6077C50.1347 68.3816 50.8008 67.2288 51.9017 66.6833L70.6326 57.4045C71.4558 56.997 72.4179 56.9818 73.2533 57.3633C74.0895 57.744 74.7083 58.4817 74.9394 59.3705C77.7264 70.0792 75.388 80.4597 68.1775 89.3891C62.8422 95.997 56.7235 99.466 56.4656 99.611C56.0025 99.8704 55.4883 100 54.974 100Z"
                  fill="#FF193D"
                />
                <path
                  d="M97.3019 24.6208L77.5754 4.89425C76.785 4.10384 75.6253 3.80935 74.5534 4.12597C61.3476 8.03222 50.507 14.1586 42.3306 22.3343C40.6254 24.0402 38.9874 25.8888 37.4631 27.8282C33.0304 33.4641 29.3278 40.1276 26.4592 47.6341C24.6319 52.4185 23.1442 57.544 22.0372 62.8678C20.1039 72.1672 20.0001 78.8323 19.9963 79.1115C19.9864 79.9332 20.3084 80.7251 20.8897 81.3065C21.4619 81.8787 22.2386 82.1999 23.0473 82.1999H23.0847C23.3647 82.1968 30.0297 82.0931 39.3284 80.1598C44.6522 79.0528 49.7777 77.565 54.5628 75.737C62.0686 72.8684 68.7321 69.1666 74.3665 64.7347C76.3074 63.2095 78.156 61.5715 79.8619 59.8656C88.0383 51.6892 94.1647 40.8485 98.0702 27.6428C98.3876 26.5709 98.0924 25.4112 97.3019 24.6208Z"
                  fill="#E1F1FA"
                />
                <path
                  d="M41.4112 75.5632L26.6315 60.7836C25.5405 59.6926 23.8063 59.588 22.5917 60.5402C21.648 61.2802 20.75 62.0752 19.923 62.9022C9.6393 73.1859 9.32115 89.1199 9.31276 89.7928C9.30208 90.6153 9.62404 91.4072 10.2062 91.9886C10.7784 92.5615 11.5543 92.8827 12.363 92.8827C12.376 92.8827 12.3889 92.8827 12.4019 92.882C13.0748 92.8736 29.0096 92.5554 39.2925 82.2718C40.1195 81.4447 40.9145 80.5468 41.6545 79.603C42.6067 78.3884 42.5022 76.6542 41.4112 75.5632Z"
                  fill="#FFF261"
                />
                <path
                  d="M26.6941 47.0237L17.6266 56.092C17.0544 56.6634 16.7324 57.4393 16.7324 58.2488C16.7324 59.0575 17.0544 59.8334 17.6266 60.4056L41.7896 84.5687C42.3611 85.1409 43.137 85.4621 43.9465 85.4621C44.7559 85.4621 45.5311 85.1409 46.1033 84.5687L55.1708 75.5012L26.6941 47.0237Z"
                  fill="#1B3B6B"
                />
                <path
                  d="M66.2771 45.2248C63.7915 45.2248 61.4538 44.2566 59.696 42.4988C56.0675 38.8703 56.0675 32.9666 59.696 29.3373C61.4538 27.5795 63.7915 26.6113 66.2771 26.6113C68.7628 26.6113 71.1004 27.5795 72.8582 29.3373C74.616 31.0951 75.5842 33.432 75.5842 35.9184C75.5842 38.4041 74.616 40.741 72.8582 42.4988C71.1004 44.2566 68.7628 45.2248 66.2771 45.2248Z"
                  fill="#06CCAB"
                />
                <path
                  d="M66.2781 48.2086C62.9951 48.2086 59.909 46.9299 57.5882 44.609C52.7961 39.817 52.7961 32.0197 57.5882 27.2277C59.909 24.9069 62.9959 23.6282 66.2781 23.6282C69.561 23.6282 72.6471 24.9069 74.9687 27.2277C77.2904 29.5493 78.5683 32.6354 78.5683 35.9184C78.5683 39.2013 77.2904 42.2874 74.9687 44.609C72.6471 46.9299 69.561 48.2086 66.2781 48.2086ZM66.2781 29.7294C64.6255 29.7294 63.0707 30.3733 61.9018 31.5421C59.4894 33.9553 59.4894 37.8814 61.9018 40.2946C63.0707 41.4634 64.6255 42.1073 66.2781 42.1073C67.9314 42.1073 69.4855 41.4634 70.6543 40.2946C71.8231 39.1258 72.467 37.5717 72.467 35.9184C72.467 34.2651 71.8231 32.711 70.6543 31.5421C69.4855 30.3733 67.9314 29.7294 66.2781 29.7294Z"
                  fill="#1B3B6B"
                />
                <path
                  d="M101.302 0.894209C100.72 0.312085 99.9235 -0.0152157 99.1056 0.000806031C98.6532 0.00614661 87.8691 0.187726 74.5527 4.12602L98.0696 27.6429C102.008 14.3265 102.189 3.54237 102.195 3.08995C102.205 2.2675 101.883 1.47557 101.302 0.894209Z"
                  fill="#FF5B5B"
                />
                <path
                  d="M97.3009 24.6209L87.4376 14.7576L20.8887 81.3065C21.4609 81.8787 22.2368 82.1999 23.0455 82.1999H23.0836C23.3629 82.1969 30.0279 82.0931 39.3274 80.1598C44.6512 79.0528 49.7759 77.5651 54.561 75.7371C62.0676 72.8684 68.7311 69.1666 74.3654 64.7347C76.3056 63.2096 78.1549 61.5716 79.8601 59.8656C88.0365 51.6892 94.1629 40.8486 98.0684 27.6429C98.3866 26.5709 98.0913 25.4113 97.3009 24.6209Z"
                  fill="#CDEBFC"
                />
                <path
                  d="M41.4128 75.5631L34.023 68.1732L10.207 91.9884V91.9892C10.78 92.5614 11.5559 92.8826 12.3646 92.8826H12.4028C13.0764 92.8742 29.0104 92.5553 39.2941 82.2716C40.1211 81.4446 40.9161 80.5466 41.6554 79.6028C42.6083 78.3882 42.5046 76.6541 41.4128 75.5631Z"
                  fill="#FDBF00"
                />
                <path
                  d="M40.9322 61.2625L29.707 72.4876L41.7889 84.5695C42.3604 85.1409 43.1363 85.4629 43.9458 85.4629C44.7552 85.4629 45.5304 85.1409 46.1026 84.5695L55.1701 75.5012L40.9322 61.2625Z"
                  fill="#001035"
                />
                <path
                  d="M72.8576 29.3373C72.8568 29.3373 72.8568 29.3373 72.8568 29.3373L59.6953 42.4988H59.6961C61.4531 44.2566 63.7908 45.2248 66.2764 45.2248C68.7621 45.2248 71.0997 44.2566 72.8576 42.4988C74.6154 40.741 75.5835 38.4041 75.5835 35.9184C75.5828 33.4327 74.6154 31.0951 72.8576 29.3373Z"
                  fill="#1CADB5"
                />
                <path
                  d="M74.9673 27.2278L70.6528 31.5422C71.8217 32.711 72.4656 34.2651 72.4656 35.9184C72.4656 37.5717 71.8217 39.1258 70.6528 40.2946C69.484 41.4635 67.9299 42.1074 66.2766 42.1074C64.6233 42.1074 63.0692 41.4635 61.9004 40.2946C61.9004 40.2946 61.9004 40.2946 61.9004 40.2939L57.5859 44.6083V44.6091C59.9076 46.9299 62.9937 48.2086 66.2766 48.2086C69.5595 48.2086 72.6456 46.9299 74.9673 44.6091C77.2881 42.2874 78.5668 39.2014 78.5668 35.9184C78.5668 32.6355 77.2881 29.5494 74.9673 27.2278Z"
                  fill="#001035"
                />
                <path
                  d="M101.301 0.893311L86.3105 15.8843L98.069 27.6427C102.007 14.3264 102.189 3.54224 102.194 3.08981C102.205 2.26736 101.883 1.47543 101.301 0.893311Z"
                  fill="#FF193D"
                />
              </g>
              <defs>
                <filter
                  id="filter0_d"
                  x="0"
                  y="0"
                  width="108.195"
                  height="108"
                  filterUnits="userSpaceOnUse"
                  color-interpolation-filters="sRGB"
                >
                  <feFlood flood-opacity="0" result="BackgroundImageFix" />
                  <feColorMatrix
                    in="SourceAlpha"
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                  />
                  <feOffset dx="2" dy="4" />
                  <feGaussianBlur stdDeviation="2" />
                  <feColorMatrix
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"
                  />
                  <feBlend
                    mode="normal"
                    in2="BackgroundImageFix"
                    result="effect1_dropShadow"
                  />
                  <feBlend
                    mode="normal"
                    in="SourceGraphic"
                    in2="effect1_dropShadow"
                    result="shape"
                  />
                </filter>
              </defs>
            </svg>
            <div class="activities-tabs__name">Развлечения и активности</div>
          </nuxt-link>
        </li>
        <li
          class="activities-tabs__item btn-disable"
          :class="{ _active: activeTable === 3 }"
        >
          <div>
            <svg
              viewBox="0 0 72 72"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M71.9836 66.8934L66.3271 35.7293C66.2707 35.4182 66.0778 35.1488 65.8013 34.9951L51.5642 27.0764C51.3794 26.9735 51.1722 26.9326 50.9688 26.9483L53.5589 60.362L53.4722 60.4008L70.5109 68.0448C70.6495 68.1068 70.7969 68.1375 70.9436 68.1375C71.1757 68.1375 71.4058 68.0611 71.5949 67.913C71.904 67.6717 72.0535 67.2791 71.9836 66.8934Z"
                fill="#44C868"
              />
              <path
                d="M35.9996 34.6465L21.4385 27.0625C21.264 26.9715 21.0705 26.9344 20.88 26.9472C20.9305 26.9441 20.9812 26.9443 21.0316 26.9483L18.4414 60.362L35.5669 68.0449C35.7051 68.1067 35.8526 68.1375 35.9996 68.1375V34.6465Z"
                fill="#44C868"
              />
              <path
                d="M21.0319 26.9485C20.8284 26.9327 20.6213 26.9736 20.4365 27.0764L6.19917 34.995C5.9227 35.1487 5.72976 35.418 5.67337 35.7292L0.0169984 66.8933C-0.0530329 67.2789 0.0965923 67.6716 0.405546 67.9132C0.594968 68.0612 0.824891 68.1376 1.05692 68.1376C1.20359 68.1376 1.35111 68.1071 1.48963 68.0449L18.4355 60.4426L21.0319 26.9485Z"
                fill="#4CE166"
              />
              <path
                d="M50.968 26.9478C50.8279 26.9586 50.6894 26.9958 50.561 27.0628L36 34.6467V68.1377C36 68.1377 36 68.1377 36.0001 68.1377C36.1471 68.1377 36.2948 68.1071 36.4328 68.0451L53.5583 60.3621L50.968 26.9478Z"
                fill="#4CE166"
              />
              <path
                d="M3.9596 45.1736L2.81055 51.5044L19.8254 42.5176L20.2204 37.4215L20.2859 36.5763L3.9596 45.1736Z"
                fill="#FFDB56"
              />
              <path
                d="M19.9781 40.5415L19.8249 42.5176L2.8101 51.5044L0.0169984 66.8934C-0.0530329 67.279 0.0965923 67.6716 0.405546 67.9132C0.594968 68.0613 0.824891 68.1377 1.05692 68.1377C1.20359 68.1377 1.35111 68.1072 1.48963 68.045L18.4355 60.4427L19.9781 40.5415Z"
                fill="#A8EEFC"
              />
              <path
                d="M36.0036 38.8239L20.2848 36.5763L19.8242 42.5176L35.9994 67.0819V58.1496L26.3473 42.9511L36.0036 44.1061V38.8239Z"
                fill="#FFBB24"
              />
              <path
                d="M64.6792 34.3718L57.8399 30.5677L51.3652 32.0806L51.4462 33.1263L51.766 37.2514L64.6792 34.3718Z"
                fill="#FFBB24"
              />
              <path
                d="M52.3406 44.6591L51.7275 36.7491L51.3657 32.0804L36.0039 38.8237V44.1058L46.0384 39.7423L52.3406 44.6591Z"
                fill="#FFDB56"
              />
              <path
                d="M71.9839 66.8933L70.5631 59.0653L51.7676 37.2513L52.3419 44.6592L71.6174 67.8934C71.9105 67.6506 72.0521 67.2692 71.9839 66.8933Z"
                fill="#FFBB24"
              />
              <path
                d="M36.0677 3.8623C27.9166 3.8623 21.2852 10.4883 21.2852 18.6327C21.2852 23.6708 23.6771 29.0798 28.3946 34.7093C31.8595 38.8441 35.2772 41.5035 35.4211 41.6147C35.6115 41.7619 35.8396 41.8355 36.0678 41.8355C36.2959 41.8355 36.5242 41.7619 36.7146 41.6147C36.8583 41.5035 40.2762 38.8441 43.741 34.7093C48.4586 29.0798 50.8505 23.6709 50.8505 18.6327C50.8502 10.4883 44.2187 3.8623 36.0677 3.8623ZM41.5422 18.6326C41.5422 21.6535 39.0911 24.1026 36.0677 24.1026C33.0442 24.1026 30.5931 21.6537 30.5931 18.6326C30.5931 15.6115 33.0442 13.1626 36.0677 13.1626C39.0911 13.1626 41.5422 15.6117 41.5422 18.6326Z"
                fill="#FF4A4A"
              />
              <path
                d="M36.0669 3.8623C35.4209 3.8623 34.7845 3.90421 34.1602 3.98493C41.414 4.92248 47.0361 11.1338 47.0361 18.6327C47.0361 23.6708 44.6442 29.0798 39.9266 34.7093C37.6984 37.3682 35.4913 39.4156 34.1603 40.569C34.8991 41.2091 35.3691 41.5751 35.4203 41.6147C35.6107 41.7619 35.8388 41.8355 36.067 41.8355C36.2951 41.8355 36.5234 41.7619 36.7138 41.6147C36.8575 41.5035 40.2754 38.8441 43.7402 34.7093C48.4578 29.0798 50.8497 23.6709 50.8497 18.6327C50.8494 10.4883 44.2179 3.8623 36.0669 3.8623Z"
                fill="#E7343F"
              />
              <path
                d="M36.4328 68.0449L42.8011 65.188L36 58.1495V68.1376C36 68.1376 36 68.1376 36.0001 68.1376C36.1471 68.1376 36.2946 68.1071 36.4328 68.0449Z"
                fill="#FFDB56"
              />
              <path
                d="M66.3254 35.7292C66.269 35.4181 66.0761 35.1487 65.7996 34.995L64.6788 34.3716L51.7656 37.2512L70.561 59.0651L66.3254 35.7292Z"
                fill="#1EA4E9"
              />
              <path
                d="M35.9997 68.1376C35.9999 68.1376 35.9999 68.1376 35.9997 68.1376V67.0817L19.8247 42.5175L18.4414 60.3621L35.5669 68.045C35.7051 68.107 35.8526 68.1376 35.9997 68.1376Z"
                fill="#1EA4E9"
              />
            </svg>
            <div class="activities-tabs__name">Карта фестиваля</div>
          </div>
        </li>
      </ul>
    </div>
    <div class="container-wide">
      <div class="activities-tabs__content">
        <p class="tab-description">
          Смотри, что покажу! Самые интересные места и события
          <b>Стримфеста 2021</b>, которые просто нельзя было пропустить.
          Демозоны, анонсы, челленджи, шоу-матчи, технологии, весь фарш и
          вау-косплей — в 2022-м будет еще круче, скоро расскажем!
        </p>
        <div class="activities-grid">
          <masonry
            :cols="{ default: 2, 767: 1 }"
            :gutter="{ default: '60px', 1024: '30px' }"
          >
            <div
              v-for="{
                id,
                border_color,
                image,
                icon,
                title,
                description,
                place,
                day,
                start
              } in activities"
              :key="id"
            >
              <div
                ref="activities"
                class="activities-item"
                :style="{ 'border-color': border_color }"
              >
                <div class="activities-item__img" v-if="image">
                  <img :src="image" alt="" loading="lazy" />
                </div>
                <div class="activities-item__content">
                  <div class="activities-item__body">
                    <div class="activities-item__title">
                      <img
                        class="activities-item__icon"
                        :src="icon"
                        alt=""
                        loading="lazy"
                      />
                      <span>{{ title }}</span>
                    </div>
                    <div
                      class="activities-item__descr"
                      v-html="description"
                    ></div>
                  </div>
                  <div class="activities-item__footer">
                    <div class="activities-item__place-id">
                      <img
                        class="activities-item__place-icon"
                        src="/activity/place-id.svg"
                        alt=""
                        loading="lazy"
                      />
                      <span>{{ place.id }}</span>
                    </div>
                    <div class="activities-item__info">
                      <div class="activities-item__place">{{ place.name }}</div>
                      <div class="activities-item__date">
                        {{ getDay(day) }}, начало {{ start }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="activities-item__corner" v-if="!image">
                  <svg
                    width="41"
                    height="41"
                    viewBox="0 0 41 41"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <g filter="url(#filter0_d)">
                      <path
                        d="M15.7722 11.7722L24.988 2.32C29.3715 -2.17586 37 0.927558 37 7.2067V26C37 29.866 33.866 33 30 33H11.2067C4.92756 33 1.82413 25.3715 6.32 20.988L15.7722 11.7722Z"
                        :fill="item.borderColor"
                      />
                    </g>
                    <defs>
                      <filter
                        id="filter0_d"
                        x="0.193359"
                        y="0.192627"
                        width="40.8074"
                        height="40.8074"
                        filterUnits="userSpaceOnUse"
                        color-interpolation-filters="sRGB"
                      >
                        <feFlood
                          flood-opacity="0"
                          result="BackgroundImageFix"
                        />
                        <feColorMatrix
                          in="SourceAlpha"
                          type="matrix"
                          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                        />
                        <feOffset dy="4" />
                        <feGaussianBlur stdDeviation="2" />
                        <feColorMatrix
                          type="matrix"
                          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"
                        />
                        <feBlend
                          mode="normal"
                          in2="BackgroundImageFix"
                          result="effect1_dropShadow"
                        />
                        <feBlend
                          mode="normal"
                          in="SourceGraphic"
                          in2="effect1_dropShadow"
                          result="shape"
                        />
                      </filter>
                    </defs>
                  </svg>
                </div>
              </div>
            </div>
          </masonry>
        </div>
      </div>
    </div>
  </section>
</template>

<script>
export default {
  scrollToTop: true,
  async asyncData({ $axios }) {
    const activities = (await $axios.get("/api/get_activities")).data.map(
      activity => {
        !activity.place &&
          (activity.place = {
            id: null,
            name: "Весь фестиваль"
          });
        return activity;
      }
    );
    // const places = activities.map(({place})=>(
    //  place ? {
    //     id: place.id,
    //     name: place.name
    //   } : {
    //     id: null,
    //     name: "Весь фестиваль"
    //   }
    // ))
    return { activities };
  },
  name: "Activities",
  data() {
    return {
      activeTable: 1,
      days: [1, 2],
      openStageList: false,
      activeStage: 1,
      activeDay: 1,
      activePlaceId: null
    };
  },
  mounted() {
    if (this.$refs.activities?.length) {
      for (const activity of this.$refs.activities) {
        for (const link of activity.querySelectorAll("a")) {
          link.classList.add("link");
        }
      }
    }
  },
  methods: {
    getDay(day) {
      let dayStr = "";
      switch (day) {
        case 1:
          dayStr = "25 июня";
          break;
        case 2:
          dayStr = "26 июня";
          break;
        case 3:
          dayStr = "25 и 26 июня";
          break;
      }
      return dayStr;
    }
  }
};
</script>
